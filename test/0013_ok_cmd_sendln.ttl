
; なんかいたら消す
testlink
if result == 2 then
    closett
endif


; 接続する
error=''
assert 1  "connect start"
connect '/cmd'
assert result == 2  "connect OK" error ; 接続失敗


result = 0
wait '>'
assert result == 1  "connect OK" error ; 接続失敗

; text
result = 0
sendln 'echo hell-world'
wait '>' '#' 
assert result == 1  "wait OK" error ; 接続失敗

; text
command = 'dir'
sendln command
wait command
result = 0
wait '#' '>'
assert result == 2 "wait OK" error ; 接続失敗

recvln
recvln
recvln
pause 1

; text
command = 'dir'
sendln command
wait command
while 1
    result = 0
    wait '<DIR>' '>'
    if result == 0 then
        assert 0 "timeout wait OK" 'title' ; 接続失敗
        end
    elseif result == 1 then
        continue
    endif
    break
endwhile

; exit
send 'exit'
sendln
pause 2
disconnect
testlink
assert result != 2  "wait OK" error ; 接続失敗
closett

pause 1

error=''
result = 1

