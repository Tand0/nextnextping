
; なんかいたら消す
testlink
if result == 2 then
    closett
endif


; 接続する
error=''
dummy "connect start"
connect 'localhost:2200 /user=aaa /passwd=bbb'
if result == 2 then
    ; 接続できている
    dummy "connect OK" error
else
    ; 接続失敗
    dummy "connect NG" error
    result = 0
    end
endif


result = 0
wait '#'
if result != 1 then
    dummy "wait fail" error
    result = 0
    end
endif

; text
sendln 'test'
result = 0
wait '#' ':'
if result != 1 then
    dummy "wait fail" error
    result = 0
    end
endif

; text
sendln 'work'
result = 0
wait ':' '#'
if result != 2 then
    dummy "wait fail" error
    result = 0
    end
endif

; タイムアウトを発生させる
timeout = 1
wait 'xxxx'
if result != 0 then
    dummy timeout error
    result = 0
    end
endif


; exit
send 'exit'
sendln
pause 2
disconnect
testlink
if result == 2 then
    ; まだ接続できている
    dummy "exit fail"
    result = 0
    end
endif
closett


error=''
result = 1
